$template{name="quickstart-page-header" title="3 Writing your first JPPF job runner"}$
$template{name="nav" url1="p2.html" url2="p4.html"}$
<br>
<h1>3 Writing your first JPPF job runner</h1>
We will see in this section how to submit our HelloWorld task for remote or local execution, and obtain the results of the execution

<h2>3.1 Initializing the JPPF client</h2>
<p>The initialization of a client is done as follows:
<p>$template{name="code_start"}$<a href="http://www.jppf.org/api/org/jppf/client/JPPFClient.html">JPPFClient</a> client = <a href="http://www.jppf.org/api/org/jppf/client/JPPFClient.html">new JPPFClient()</a>;$template{name="code_end"}$
<p>This single statement instructs the JPPF client to read its configuration and connect with one or multiple JPPF servers accordingly.
If it cannot connect to any server, the client will perform local execution of the tasks, if local execution is enabled in the configuration.

<h2>3.2 Creating a job with a HelloWorld task</h2>
<p>The creation of a job with a single task is shown below:
<p>$template{name="code_start"}$<a href="http://www.jppf.org/api/org/jppf/client/JPPFJob.html">JPPFJob</a> job = new <a href="http://www.jppf.org/api/org/jppf/client/JPPFJob.html">JPPFJob()</a>;
job.<a href="http://www.jppf.org/api/org/jppf/client/JPPFJob.html#addTask(java.lang.Object,%20java.lang.Object...)">addTask(new HelloWorld())</a>;$template{name="code_end"}$
<p>Our job is now ready for submission, whether local or remote.

<h2>3.3 Submitting a job for execution</h2>
<p>$template{name="code_start"}$
List&lt;<a href="http://www.jppf.org/api/org/jppf/server/protocol/JPPFTask.html">JPPFTask</a>&gt; results = client.<a href="http://www.jppf.org/api/org/jppf/client/AbstractJPPFClient.html#submit(org.jppf.client.JPPFJob)">submit(job)</a>;$template{name="code_end"}$
<p>This single statement invites a number of remarks:
<ul>
	<li>The same code is used for local or remote execution of the job.
	The decision on where the execution is performed is made through the client's configuration, as detailed in <a href="p4.html">Section 4</a> of this tutorial.</li>
	<li>Submitting a job and obtaining the execution results are done in a single method call. This is but one mode of submission of JPPF jobs, albeit the most common and most used.
	JPPF also provides asynchronous modes of submission, which is a more advanced feature.
	Please refer to the <a href="http://www.jppf.org/wiki/index.php?title=Programming">JPPF programming guide</a> for more details on this feature.</li>
	<li>The results are returned as a list of <code>JPPFTask</code> objects. Each of these tasks corresponds to a task that was submitted, and appears in the same order in the results list.
	However, an input task and a result task <i>are not the same object</i>. A result task is an object that was created remotely and sent to the client through a network connection.
	This is an important consideration if your tasks are large and your application needs a lot of memory.</li>
</ul>

<h2>3.4 Processing the execution results</h2>
<p>Once we have obtained the execution results, we can inspect their content for normal or error processing.
<p>To determine whether a task execution ended in error, we can check for a resulting exception:
<p>$template{name="code_start"}$<a href="http://www.jppf.org/api/org/jppf/server/protocol/JPPFTask.html">JPPFTask</a> task = results.get(0);
if (task.<a href="http://www.jppf.org/api/org/jppf/server/protocol/JPPFTask.html#getException()">getException()</a> != null) throw task.<a href="http://www.jppf.org/api/org/jppf/server/protocol/JPPFTask.html#getException()">getException()</a>;$template{name="code_end"}$
<p>If no exception has occurred, we can extract the result of the execution of our task:
<p>$template{name="code_start"}$<a href="http://www.jppf.org/api/org/jppf/server/protocol/JPPFTask.html">JPPFTask</a> task = results.get(0);
String hello = (String) task.<a href="http://www.jppf.org/api/org/jppf/server/protocol/JPPFTask.html#getResult()">getResult()</a>;$template{name="code_end"}$

<h2>3.5 Putting it all together</h2>
<p> Here is the full code of our JPPF job runner:

<p>$template{name="code_start"}$
package org.jppf.helloworld;

import java.io.*;
import java.util.List;

import org.jppf.client.*;
import org.jppf.server.protocol.JPPFTask;

<font color="green">/**
 * Runner for the hello world application.
 */</font>
public class HelloWorldRunner
{
  <font color="green">/**
   * Entry point.
   */</font>
  public static void main(String...args)
  {
    <a href="http://www.jppf.org/api/org/jppf/client/JPPFClient.html">JPPFClient</a> client = null;
    try
    {
      client = <a href="http://www.jppf.org/api/org/jppf/client/JPPFClient.html">new JPPFClient()</a>;
      <a href="http://www.jppf.org/api/org/jppf/client/JPPFJob.html">JPPFJob</a> job = new <a href="http://www.jppf.org/api/org/jppf/client/JPPFJob.html">JPPFJob()</a>;
      job.<a href="http://www.jppf.org/api/org/jppf/client/JPPFJob.html#addTask(java.lang.Object,%20java.lang.Object...)">addTask(new HelloWorld())</a>;
      List<<a href="http://www.jppf.org/api/org/jppf/server/protocol/JPPFTask.html">JPPFTask</a>> results = client.<a href="http://www.jppf.org/api/org/jppf/client/AbstractJPPFClient.html#submit(org.jppf.client.JPPFJob)">submit(job)</a>;
      for (<a href="http://www.jppf.org/api/org/jppf/server/protocol/JPPFTask.html">JPPFTask</a> task: results)
      {
        if (task.<a href="http://www.jppf.org/api/org/jppf/server/protocol/JPPFTask.html#getException()">getException()</a> != null) throw task.<a href="http://www.jppf.org/api/org/jppf/server/protocol/JPPFTask.html#getException()">getException()</a>;
        System.out.println("Result: " + task.<a href="http://www.jppf.org/api/org/jppf/server/protocol/JPPFTask.html#getResult()">getResult()</a>);
      }
    }
    catch(Exception e)
    {
      e.printStackTrace();
    }
    finally
    {
      if (client != null) client.<a href="http://www.jppf.org/api/org/jppf/client/JPPFClient.html#close()">close()</a>;
    }
  }
}$template{name="code_end"}$

<p>The Java file for this code can be downloaded here: <a href="../src/org/jppf/helloworld/HelloWorldRunner.java">HelloWorldRunner.java</a>

$template{name="nav" url1="p2.html" url2="p4.html"}$

$template{name="quickstart-page-footer"}$
